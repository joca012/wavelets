<html>

<head>
	<title>Wavelet of the PPG</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/discrete-wavelets@5/dist/discrete-wavelets.umd.min.js"></script>

	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
	<label for="signals">Signals</label>
	<select id="signals" name="signals">
		<option disabled selected>Choose a signal...</option>
		<option value="ppg1">ppg</option>
		<option value="ppg2">ppg 54 f</option>
		<option value="ppg3">ppg 30 m no</option>
		<option value="ppg4">ppg 43 f 160bpm exercise</option>
		<option value="ppg5">ppg 54 m noisy</option>
		<option value="ppg6">ppg 60 m noisy</option>
	</select>

	<label for="wavelets">Wavelets</label>
	<select id="wavelets" name="wavelets">
		<option disabled selected>Choose a wavelet...</option>
		<option value="db2">db2</option>
		<option value="db4">db4</option>
	</select>

	<br/>
	<label for="reconstructs">Reconstructs</label>
	<div id="reconstructsCBs" style="display: inline;"></div>

	<canvas id="ppgCanvas" height="50"></canvas>
	<canvas id="waveletCanvas" height="50"></canvas>
	<div id="scalesWrapper"></div>
	<canvas id="reconstructCanvas" height="50"></canvas>
	
	<script>
		// Data sets:
		var ppg1 = [-20783, -20962, -21122, -21251, -21341, -21381, -21431, -21541, -21770, -22149, -22637, -23145, -23614, -23963, -24062, -23793, -23036, -21680, -19796, -17444, -14722, -11732, -8622, -5562, -2741, -289, 1754, 3419, 4724, 5691, 6389, 6868, 7216, 7486, 7655, 7695, 7565, 7236, 6708, 5980, 5053, 3957, 2761, 1614, 608, -139, -647, -976, -1156, -1255, -1285, -1255, -1166, -1026, -867, -717, -627, -608, -687, -857, -1116, -1465, -1893, -2372, -2870, -3389, -3907, -4415, -4904, -5382, -5851, -6349, -6907, -7545, -8243, -8921, -9529, -10017, -10436, -10875, -11433, -12190, -13078, -13965, -14712, -15211, -15470, -15600, -15669, -15789, -15978, -16218, -16517, -16866, -17244, -17643, -18052, -18450, -18799, -19068, -19198, -19158, -18829, -18072, -16746, -14712, -12071, -9031, -5801, -2601, 458, 3309, 5901, 8153, 10077, 11712, 13088, 14244, 15201, 15988, 16606, 17085, 17424, 17593, 17583, 17364, 16945, 16337, 15550, 14593, 13506, 12380, 11293, 10307, 9479, 8801, 8293, 7954, 7755, 7675, 7655, 7655, 7665, 7665, 7645, 7615, 7555, 7426, 7236, 6937, 6549, 6080, 5522, 4904, 4246, 3568, 2880, 2212, 1574, 937, 289, -398, -1116, -1824, -2501, -3110, -3658, -4146, -4595, -5023, -5442, -5841, -6240, -6638, -7027, -7416, -7795, -8153, -8502, -8841, -9160, -9469, -9788, -10207, -10785, -11602, -12599, -13576, -14314, -14603, -14344, -13496, -12061, -10017, -7436, -4475, -1315, 1893, 5003, 7924, 10546, 12769, 14603, 16158, 17563, 18959, 20364, 21650, 22717, 23415, 23724, 23724, 23474, 23076, 22547, 21889, 21072, 20075, 18909, 17683, 16457, 15350, 14393, 13586, 12918, 12380, 11961, 11652, 11433, 11293, 11204, 11134, 11044, 10915, 10715, 10446, 10127, 9768, 9350, 8901, 8423, 7904, 7356, 6778, 6190, 5582, 4964, 4316, 3658, 2980, 2282, 1584, 907, 289, -269, -787, -1285, -1784, -2282, -2781, -3259, -3698, -4076, -4425, -4754, -5073, -5402, -5741, -6130, -6568, -7067, -7655, -8343, -9130, -10007, -10825, -11453, -11742, -11582, -10944, -9808, -8153, -6000, -3448, -637, 2332, 5322, 8253, 11034, 13566, 15799, 17733, 19417, 20863, 22089, 23116, 23913, 24491, 24850, 25000, 24950, 24700, 24282, 23684, 22896, 21919, 20763, 19527, 18311, 17214, 16307, 15580, 14992, 14533, 14164, 13875, 13656, 13506, 13407, 13347, 13297, 13247, 13167, 13038, 12838, 12549, 12151, 11652, 11094, 10476, 9838, 9180, 8502, 7814, 7127, 6429, 5701, 4954, 4166, 3349, 2531, 1724, 937, 199, -468, -1036, -1495, -1864, -2173, -2452, -2711, -2980, -3259, -3548, -3847, -4176, -4545, -4974, -5452, -6010, -6628, -7316, -8074, -8821, -9489, -9998, -10257, -10197, -9768, -8891, -7525, -5701, -3498, -976, 1784, 4645, 7476, 10117, 12460, 14503, 16277, 17832, 19188, 20374, 21381, 22238, 22926, 23425, 23694, 23684, 23375, 22787, 21979, 20982, 19866, 18660, 17444, 16257, 15171, 14214, 13417, 12838, 12480, 12320, 12310, 12380, 12490, 12609, 12699, 12729, 12689, 12569, 12390, 12131, 11832, 11473, 11074, 10645, 10177, 9669, 9120, 8512, 7834, 7117, 6419, 5761, 5183, 4665, 4126, 3508, 2751, 1903, 1066, 328, -209, -568, -807, -966, -1116, -1275, -1445, -1634, -1834, -2063, -2342, -2681, -3090, -3568, -4096, -4675, -5273, -5881, -6439, -6937, -7326, -7515, -7416, -6917, -5911, -4395, -2422, -49, 2671, 5602, 8562, 11363, 13845, 15929, 17663, 19078, 20195, 21072, 21730, 22218, 22567, 22787, 22807, 22587, 22089, 21311, 20324, 19168, 17902, 16596, 15330, 14184, 13227, 12509, 12011, 11722, 11642, 11732, 11901, 12081, 12200, 12230, 12161, 12021, 11812, 11533, 11224, 10875, 10506, 10127, 9718, 9280, 8781, 8243, 7675, 7097, 6529, 5960, 5412, 4864, 4306, 3748, 3189, 2611, 2033, 1455, 887, 348, -169, -657, -1146, -1654, -2222, -2830, -3438, -3997, -4475, -4854, -5163, -5442, -5721, -6020, -6369, -6798, -7316, -7914, -8572, -9230, -9858, -10386, -10725, -10785, -10466, -9718, -8562, -7007, -5073, -2830, -408, 2063, 4425, 6618, 8632, 10466, 12121, 13596, 14862, 15889, 16646, 17145, 17424, 17513, 17454, 17274, 16935, 16417, 15689, 14762, 13686, 12539, 11383, 10277, 9290, 8472, 7894, 7565, 7436, 7436, 7505, 7595, 7665, 7685, 7605, 7436, 7187, 6907, 6618, 6339, 6040, 5691, 5253, 4724, 4136, 3548, 2980, 2462, 1973, 1475, 937, 358, -259, -877, -1495, -2093, -2651, -3179, -3668, -4106, -4525, -4934, -5352, -5791, -6240, -6678, -7077, -7436, -7765, -8064, -8363, -8642, -8931, -9220, -9499, -9788, -10117, -10496, -10964, -11523, -12091, -12579, -12888, -12918, -12579, -11752, -10316, -8243, -5691, -2860, 79, 2950, 5661, 8163, 10366, 12220, 13765, 15051, 16108, 16985, 17693, 18251, 18680, 18979, 19118, 19039, 18710, 18112, 17294, 16327, 15291, 14224, 13177, 12181, 11263, 10456, 9758, 9200, 8761, 8462, 8283, 8183, 8153, 8163, 8173, 8163, 8094, 7944, 7715, 7446, 7147, 6838, 6489, 6090, 5631, 5073, 4455, 3797, 3129, 2462, 1804, 1146, 468, -229, -937, -1634, -2302, -2930, -3528, -4096, -4645, -5173, -5691, -6190, -6668, -7117, -7555, -7994, -8423, -8851, -9260, -9619, -9918, -10137, -10356, -10685, -11234, -12081, -13108, -14154, -15041, -15600, -15779, -15540, -14832, -13626, -11941, -9788, -7216, -4256, -1066, 2143, 5173, 7854, 10167, 12171, 13925, 15470, 16816, 17962, 18889, 19607, 20105, 20394, 20464, 20324, 19986, 19477, 18829, 18042, 17155, 16188, 15161, 14094, 13038, 12051, 11194, 10516, 10007, 9639, 9370, 9180, 9031, 8891, 8751, 8582, 8373, 8124, 7864, 7575, 7256, 6917, 6519, 6080, 5592, 5053, 4465, 3847, 3179, 2482, 1744, 976, 199, -558, -1265, -1893, -2462, -2990, -3508, -4057, -4625, -5203, -5771, -6309, -6828, -7316, -7795, -8243, -8682, -9080, -9419, -9718, -9998, -10336, -10815, -11493, -12360, -13317, -14284, -15171, -15929, -16517, -16895, -17035, -16846, -16248, -15151, -13456, -11224, -8572, -5651, -2601, 458, 3389, 6060, 8373, 10277, 11852, 13157, 14254, 15161, 15899, 16477, 16895, 17155, 17264, 17214, 16995, 16586, 15988, 15161, 14084, 12809, 11453, 10137, 8961, 7974, 7167, 6489, 5940, 5502, 5153, 4884, 4685, 4555, 4455, 4395, 4336, 4266, 4146, 3927, 3578, 3090, 2511, 1864, 1186, 508, -179, -877, -1574, -2272, -2970, -3668, -4366, -5053, -5751, -6449, -7157, -7874, -8592, -9320, -10057, -10795, -11523, -12200, -12838, -13417, -14005, -14623, -15330, -16118, -16915, -17663, -18291, -18789, -19208, -19597, -20015, -20494, -21002, -21551, -22119, -22657, -23046, -23195, -22996, -22348, -21192, -19477, -17135, -14234, -11004, -7675, -4485, -1594, 976, 3239, 5193, 6848, 8223, 9379, 10326, 11104, 11702, 12131, 12380, 12450, 12340, 12031, 11513, 10795, 9938, 8991, 7994, 7007, 6060, 5163, 4336, 3628, 3040, 2591, 2312, 2192, 2163, 2153, 2093, 1943, 1724, 1465, 1196, 937, 667, 368, 19, -388, -867, -1415, -2033, -2721, -3458, -4226, -4974, -5711, -6439, -7157, -7874, -8592, -9310, -10027, -10725, -11393, -12021, -12589, -13088, -13516, -13945, -14453, -15131, -15998, -16935, -17832, -18560, -19019, -19298, -19477, -19657, -19896, -20215, -20584, -21022, -21491, -21999, -22498, -22976, -23395, -23624, -23544, -23026, -21959, -20354, -18211, -15560, -12440, -9070, -5691, -2521, 249, 2621, 4625, 6319, 7725, 8881, 9808, 10546, 11104, 11493, 11702, 11712, 11523, 11134, 10546, 9768, 8811, 7735, 6598, 5472, 4415, 3458, 2601, 1854, 1236, 757, 428, 259, 239, 338, 478, 627, 707, 707, 618, 408, 79, -328, -767, -1176, -1535, -1854, -2192, -2581, -3060, -3608, -4186, -4764, -5322, -5851, -6379, -6897, -7436, -8004, -8612, -9260, -9958, -10685, -11393, -12061, -12659, -13217, -13785, -14413, -15131, -15909, -16646, -17264, -17713, -18032, -18291, -18580, -18969, -19457, -20015, -20614, -21212, -21770, -22238, -22557, -22667, -22478, -21870, -20753, -19019, -16756, -14104, -11204, -8193, -5213, -2412, 69, 2103, 3718, 4964, 5940, 6698, 7276, 7655, 7834, 7805, 7595, 7196, 6628, 5921, 5063, 4057, 2920, 1644, 309, -986, -2163, -3129, -3867, -4425, -4824, -5103, -5273, -5342, -5303, -5183, -5003, -4844, -4754, -4804, -4994, -5322, -5781, -6349, -6977, -7595, -8133, -8512, -8751, -8891, -9001, -9120, -9270, -9459, -9669, -9908, -10217, -10665, -11323, -12250, -13367, -14543, -15600, -16407, -16945, -17294, -17543, -17773, -18012, -18261, -18540, -18839, -19158, -19507, -19866, -20255, -20653, -21082, -21531, -21999, -22498, -23006, -23534, -24082, -24571, -24920, -25000, -24720, -24003, -22787, -21012, -18640, -15769, -12599, -9360, -6269, -3438, -887, 1385, 3369];
		// 54 f
		var ppg2 = [-1554, -2061, -2579, -3098, -3626, -4166, -4706, -5278, -5850, -6444, -7048, -7642, -8236, -8808, -9358, -9876, -10362, -10805, -11204, -11582, -11949, -12284, -12629, -12964, -13298, -13655, -14022, -14421, -14863, -15338, -15867, -16450, -17076, -17648, -18059, -18221, -18026, -17379, -16180, -14335, -11852, -8883, -5569, -2061, 1489, 4943, 8160, 10988, 13417, 15457, 17130, 18458, 19462, 20174, 20606, 20779, 20703, 20401, 19894, 19181, 18285, 17206, 15986, 14626, 13169, 11658, 10125, 8603, 7145, 5775, 4544, 3432, 2461, 1597, 841, 172, -399, -906, -1349, -1737, -2083, -2396, -2687, -2968, -3249, -3551, -3853, -4188, -4533, -4889, -5256, -5634, -6034, -6433, -6843, -7264, -7696, -8139, -8592, -9067, -9553, -10060, -10578, -11085, -11593, -12068, -12521, -12920, -13277, -13579, -13838, -14075, -14313, -14572, -14853, -15198, -15608, -16083, -16580, -17044, -17433, -17713, -17821, -17724, -17379, -16742, -15803, -14540, -12920, -10924, -8538, -5731, -2504, 1003, 4652, 8311, 11809, 15004, 17746, 19905, 21405, 22312, 22733, 22733, 22409, 21848, 21135, 20336, 19505, 18620, 17681, 16677, 15598, 14432, 13180, 11830, 10427, 8991, 7588, 6250, 5008, 3918, 3022, 2331, 1813, 1457, 1208, 1047, 928, 820, 701, 550, 356, 140, -118, -410, -723, -1079, -1468, -1878, -2320, -2795, -3292, -3821, -4371, -4933, -5526, -6131, -6735, -7340, -7933, -8506, -9067, -9585, -10071, -10513, -10934, -11312, -11658, -11981, -12273, -12532, -12780, -13018, -13266, -13557, -13881, -14270, -14723, -15263, -15770, -16137, -16267, -16018, -15284, -13968, -11938, -9175, -5850, -2137, 1781, 5731, 9520, 12996, 15954, 18372, 20293, 21783, 22905, 23715, 24276, 24654, 24892, 25000, 24978, 24805, 24471, 23974, 23283, 22420, 21351, 20131, 18793, 17368, 15889, 14399, 12931, 11528, 10189, 8959, 7815, 6778, 5872, 5073, 4425, 3907, 3519, 3227, 3011, 2838, 2687, 2525, 2331, 2094, 1791, 1446, 1057, 626, 161, -323, -841, -1370, -1932, -2504, -3087, -3691, -4306, -4933, -5569, -6206, -6843, -7458, -8052, -8603, -9099, -9553, -9930, -10265, -10567, -10859, -11150, -11485, -11863, -12305, -12813, -13363, -13892, -14367, -14745, -14982, -15047, -14885, -14453, -13741, -12694, -11301, -9520, -7318, -4674, -1554, 1910, 5580, 9304, 12910, 16245, 19160, 21502, 23164, 24212, 24740, 24859, 24643, 24201, 23629, 23013, 22398, 21761, 21081, 20315, 19440, 18426, 17249, 15878, 14356, 12726, 11053, 9401, 7825, 6379, 5138, 4123, 3335, 2720, 2256, 1889, 1597, 1349, 1090, 798, 485, 161, -194, -550, -928, -1316, -1705, -2094, -2504, -2914, -3346, -3810, -4285, -4792, -5332, -5904, -6487, -7070, -7653, -8236, -8786, -9315, -9812, -10276, -10708, -11118, -11496, -11863, -12208, -12543, -12877, -13223, -13590, -14011, -14486, -15047, -15695, -16439, -17217, -17918, -18426, -18631, -18436, -17724, -16386, -14367, -11765, -8743, -5429, -1975, 1489, 4803, 7825, 10492, 12802, 14766, 16407, 17735, 18760, 19505, 19980, 20196, 20164, 19905, 19419, 18717, 17821, 16742, 15479, 14075, 12575, 11010, 9423, 7847, 6314, 4879, 3562, 2353, 1252, 269, -604, -1360, -2018, -2569, -3022, -3400, -3713, -3972, -4209, -4436, -4663, -4911, -5181, -5472, -5796, -6142, -6519, -6919, -7361, -7825, -8311, -8819, -9337, -9855, -10373, -10891, -11388, -11873, -12338, -12780, -13201, -13601, -13978, -14324, -14658, -14961, -15274, -15587, -15921, -16288, -16699, -17174, -17713, -18285, -18847, -19386, -19840, -20185, -20390, -20401, -20207, -19743, -18976, -17875, -16396, -14486, -12122, -9250, -5969, -2417, 1262, 4889, 8333, 11442, 14043, 16019, 17400, 18264, 18696, 18771, 18566, 18156, 17627, 17033, 16353, 15587, 14723, 13741, 12629, 11377, 9963, 8419, 6800, 5138, 3486, 1921, 464, -820, -1889, -2752, -3432, -3972, -4393, -4727, -5008, -5267, -5526, -5796, -6066, -6357, -6649, -6962, -7286, -7620, -7977, -8354, -8743, -9153, -9585, -10038, -10513, -11010, -11539, -12079, -12661, -13255, -13892, -14550, -15241, -15943, -16591, -17076, -17314, -17217, -16677, -15598, -13903, -11560, -8732, -5569, -2212, 1155, 4404, 7351, 9866, 11895, 13493, 14691, 15544, 16105, 16407, 16504, 16450, 16234, 15857, 15317, 14615, 13730, 12672, 11431, 10028, 8484, 6876, 5235, 3616, 2072, 658, -593, -1640, -2515, -3249, -3842, -4317, -4706, -5030, -5300, -5526, -5731, -5926, -6098, -6293, -6498, -6724, -6984, -7286, -7620, -7998, -8419, -8883, -9391, -9952, -10546, -11161, -11798, -12435, -13061, -13655, -14205, -14702, -15144, -15533, -15889, -16213, -16515, -16806, -17098, -17379, -17670, -17972, -18264, -18555, -18857, -19149, -19440, -19721, -20002, -20272, -20531, -20779, -21027, -21254, -21459, -21664, -21858, -22063, -22279, -22517, -22787, -23089, -23445, -23823, -24190, -24525, -24784, -24956, -25000, -24892, -24589, -24028, -23175, -21955, -20315, -18188, -15533, -12284, -8495, -4339, 0, 4328, 8462, 12230, 15425, 17897, 19635, 20768, 21383, 21599, 21524, 21265, 20930, 20606, 20272, 19894, 19440, 18857, 18123, 17184, 16008, 14583, 12985, 11269, 9509, 7750, 6077, 4544, 3216, 2104, 1176, 420, -194, -712, -1133, -1511, -1856, -2180, -2482, -2774, -3044, -3303, -3562, -3810, -4058, -4306, -4566, -4846, -5148, -5483, -5861, -6271, -6735, -7232, -7750, -8290, -8840, -9380, -9930, -10459, -10967, -11452, -11927, -12392, -12823, -13244, -13655, -14043, -14432, -14831, -15252, -15705, -16202, -16774, -17411, -18091, -18706, -19170, -19376, -19224, -18598, -17422, -15587, -13147, -10243, -7016, -3594, -118, 3259, 6401, 9207, 11647, 13752, 15533, 17012, 18188, 19106, 19764, 20185, 20379, 20347, 20110, 19667, 19019, 18188, 17184, 16019, 14723, 13331, 11884, 10395, 8905, 7448, 6055, 4727, 3486, 2353, 1327, 420, -356, -993, -1468, -1835, -2104, -2320, -2493, -2655, -2849, -3098, -3400, -3767, -4177, -4630, -5116, -5634, -6163, -6703, -7243, -7804, -8354, -8916, -9477, -10038, -10600, -11161, -11712, -12240, -12759, -13234, -13687, -14086, -14432, -14734, -15004, -15263, -15522, -15813, -16148, -16537, -17012, -17551, -18134, -18717, -19278, -19786, -20207, -20520, -20671, -20628, -20304, -19656, -18620, -17120, -15112, -12521, -9358, -5775, -1943, 1953, 5753, 9283, 12359, 14831, 16645, 17886, 18642, 18998, 19052, 18890, 18609, 18264, 17886, 17443, 16904, 16234, 15436, 14453, 13287, 11906, 10373, 8754, 7091, 5462, 3918, 2525, 1349, 399, -356, -949, -1414, -1781, -2094, -2385, -2687, -3011, -3357, -3713, -4080, -4458, -4835, -5213, -5602, -5980, -6379, -6789, -7210, -7664, -8139, -8657, -9207, -9779, -10373, -10967, -11550, -12122, -12672, -13190, -13665, -14108, -14529, -14907, -15274, -15608, -15932, -16245, -16547, -16871, -17206, -17584, -18015, -18512, -19073, -19710, -20358, -20962, -21437, -21740, -21783, -21534, -20898, -19872, -18458, -16709, -14615, -12219, -9542, -6606, -3432, -118, 3249, 6541, 9650, 12478, 14917, 16850, 18199, 19030, 19408, 19408, 19117, 18598, 17929, 17195, 16429, 15619, 14756, 13816, 12802, 11679, 10449, 9088, 7631, 6109, 4587, 3098, 1694, 410, -680, -1565, -2256, -2784, -3173, -3465, -3680, -3864, -4047, -4242, -4468, -4717, -4997, -5321, -5677, -6077, -6519, -7016, -7534, -8085, -8646, -9207, -9768, -10308, -10837, -11334, -11819, -12294, -12759, -13212, -13665, -14129, -14594, -15058, -15511, -15954, -16353, -16731, -17055, -17335, -17562, -17767, -17962, -18177, -18436, -18771, -19181, -19699, -20250, -20703, -20941, -20833, -20272, -19117, -17260, -14615, -11334, -7599, -3594, 485, 4447, 8117, 11291, 13870, 15921, 17508, 18685, 19538, 20120, 20509, 20757, 20898, 20908, 20779, 20487, 20023, 19365, 18512, 17443, 16191, 14820, 13352, 11852, 10351, 8916, 7577, 6368, 5289, 4339, 3497, 2763, 2126, 1575, 1111, 723, 377, 86, -183, -431, -680, -939, -1219, -1532, -1878, -2234, -2623, -3022, -3454, -3886, -4339, -4814, -5289, -5785, -6282, -6800, -7318, -7847, -8376, -8905, -9412, -9887, -10330, -10708, -11031, -11280, -11463, -11604, -11744, -11895, -12089, -12348, -12694, -13147, -13665, -14194, -14658, -15015, -15209, -15177, -14853, -14205, -13234, -11927, -10287, -8300, -5980, -3324, -323, 2957, 6390, 9833, 13180, 16288, 19041, 21308, 22981, 24093, 24730, 24956, 24881, 24579, 24125, 23607, 23089, 22549, 21955, 21297, 20541, 19656, 18631, 17433, 16083, 14615, 13082, 11539, 10038, 8635, 7383, 6314, 5440, 4727, 4155, 3702, 3335, 3033, 2774, 2525, 2277, 2029, 1770, 1500, 1219, 895, 539, 151, -280, -734, -1230, -1748, -2299, -2860, -3454, -4058, -4684, -5300, -5926, -6541, -7135, -7718, -8268, -8797, -9294, -9779, -10233, -10675, -11096, -11506, -11895, -12273, -12640, -13007];
		// 30 m no
		var ppg3 = [2737, 2362, 1998, 1614, 1219, 804, 389, -15, -409, -794, -1168, -1553, -1947, -2383, -2848, -3364, -3951, -4579, -5216, -5843, -6441, -7007, -7533, -8009, -8475, -8950, -9486, -10124, -10842, -11571, -12219, -12755, -13200, -13625, -14101, -14668, -15295, -15953, -16590, -17187, -17744, -18270, -18746, -19150, -19474, -19656, -19667, -19444, -18918, -18037, -16752, -15153, -13352, -11450, -9537, -7635, -5783, -4022, -2342, -743, 794, 2281, 3729, 5105, 6410, 7635, 8738, 9709, 10509, 11126, 11571, 11875, 12037, 12087, 12026, 11854, 11601, 11267, 10853, 10387, 9881, 9325, 8738, 8130, 7493, 6866, 6258, 5702, 5206, 4761, 4366, 4002, 3668, 3364, 3061, 2757, 2443, 2089, 1684, 1219, 713, 177, -369, -915, -1482, -2069, -2696, -3354, -4052, -4811, -5601, -6400, -7139, -7776, -8282, -8697, -9102, -9567, -10124, -10721, -11359, -11976, -12583, -13170, -13737, -14303, -14860, -15416, -15983, -16550, -17127, -17693, -18240, -18746, -19211, -19596, -19889, -20031, -19899, -19403, -18452, -17106, -15497, -13757, -11996, -10266, -8566, -6926, -5337, -3779, -2221, -622, 1006, 2595, 4093, 5439, 6643, 7726, 8707, 9628, 10478, 11237, 11895, 12421, 12785, 12947, 12846, 12502, 11976, 11308, 10589, 9851, 9142, 8525, 8019, 7614, 7260, 6916, 6542, 6157, 5752, 5337, 4923, 4498, 4052, 3597, 3121, 2646, 2160, 1674, 1189, 703, 197, -328, -855, -1381, -1877, -2352, -2828, -3334, -3901, -4528, -5186, -5854, -6521, -7159, -7756, -8292, -8778, -9213, -9658, -10124, -10630, -11176, -11743, -12310, -12876, -13443, -14030, -14637, -15255, -15882, -16519, -17157, -17774, -18351, -18847, -19242, -19464, -19434, -19090, -18412, -17440, -16206, -14759, -13119, -11348, -9497, -7594, -5692, -3820, -2049, -379, 1178, 2625, 3971, 5236, 6400, 7473, 8454, 9355, 10144, 10853, 11439, 11895, 12158, 12178, 11945, 11541, 11035, 10529, 10063, 9618, 9183, 8738, 8252, 7716, 7119, 6441, 5732, 5064, 4498, 4093, 3799, 3546, 3273, 2949, 2575, 2180, 1755, 1320, 855, 349, -187, -764, -1320, -1826, -2271, -2686, -3111, -3587, -4143, -4740, -5358, -5945, -6511, -7058, -7624, -8222, -8839, -9466, -10083, -10670, -11237, -11804, -12370, -12957, -13554, -14141, -14738, -15325, -15902, -16489, -17076, -17653, -18230, -18766, -19262, -19616, -19737, -19515, -18877, -17855, -16489, -14789, -12846, -10751, -8616, -6532, -4579, -2757, -1097, 399, 1786, 3152, 4589, 6096, 7483, 8464, 8788, 8475, 7999, 7847, 8505, 9881, 11450, 12664, 13028, 12654, 11865, 10994, 10306, 9780, 9314, 8839, 8292, 7685, 7038, 6370, 5702, 5064, 4467, 3931, 3465, 3020, 2575, 2109, 1614, 1087, 541, -35, -642, -1259, -1887, -2524, -3152, -3759, -4336, -4892, -5439, -5995, -6582, -7210, -7847, -8505, -9183, -9871, -10579, -11318, -12057, -12765, -13382, -13888, -14293, -14678, -15103, -15619, -16236, -16924, -17653, -18412, -19150, -19839, -20466, -20992, -21437, -21812, -22136, -22338, -22328, -21994, -21255, -20122, -18665, -16944, -15022, -12937, -10721, -8414, -6066, -3779, -1654, 207, 1816, 3233, 4548, 5823, 7088, 8353, 9618, 10863, 11986, 12907, 13514, 13757, 13726, 13484, 13140, 12715, 12219, 11632, 10954, 10215, 9466, 8748, 8090, 7503, 6957, 6430, 5904, 5368, 4771, 4113, 3395, 2696, 2069, 1573, 1178, 784, 288, -369, -1158, -1968, -2706, -3334, -3850, -4305, -4740, -5186, -5621, -6076, -6552, -7058, -7614, -8262, -8991, -9770, -10488, -11075, -11520, -12026, -12836, -14172, -16013, -17875, -19242, -19656, -19181, -18361, -17744, -17815, -18503, -19495, -20486, -21255, -21832, -22328, -22854, -23441, -23988, -24402, -24585, -24433, -23886, -22864, -21306, -19302, -17025, -14637, -12259, -9972, -7776, -5732, -3840, -2069, -399, 1189, 2717, 4194, 5641, 7048, 8404, 9658, 10782, 11743, 12543, 13160, 13625, 13939, 14081, 14060, 13858, 13484, 12947, 12290, 11520, 10681, 9820, 9011, 8282, 7645, 7058, 6501, 5945, 5398, 4832, 4234, 3627, 3010, 2413, 1856, 1330, 814, 298, -258, -834, -1452, -2089, -2767, -3445, -4123, -4771, -5388, -5995, -6592, -7220, -7857, -8515, -9163, -9820, -10468, -11146, -11875, -12644, -13433, -14202, -14900, -15528, -16105, -16661, -17228, -17815, -18402, -18958, -19484, -19980, -20486, -21043, -21670, -22318, -22925, -23441, -23785, -23836, -23492, -22652, -21296, -19555, -17572, -15467, -13312, -11116, -8910, -6704, -4548, -2474, -531, 1280, 2980, 4609, 6198, 7756, 9244, 10640, 11885, 12957, 13858, 14556, 15052, 15305, 15305, 15032, 14496, 13767, 12968, 12178, 11460, 10812, 10215, 9658, 9132, 8616, 8100, 7554, 6987, 6380, 5752, 5105, 4477, 3890, 3395, 2990, 2595, 2140, 1553, 844, 75, -672, -1330, -1897, -2433, -2980, -3567, -4204, -4882, -5601, -6319, -7038, -7716, -8333, -8879, -9395, -9932, -10519, -11146, -11763, -12340, -12856, -13332, -13848, -14445, -15174, -15993, -16863, -17744, -18604, -19444, -20223, -20931, -21589, -22247, -22945, -23694, -24392, -24878, -25000, -24666, -23886, -22713, -21195, -19393, -17410, -15325, -13241, -11187, -9153, -7139, -5135, -3162, -1249, 571, 2281, 3880, 5368, 6734, 7969, 9082, 10053, 10873, 11531, 12006, 12290, 12350, 12209, 11875, 11389, 10761, 10043, 9284, 8515, 7776, 7078, 6430, 5823, 5257, 4700, 4133, 3526, 2878, 2170, 1411, 602, -217, -966, -1583, -2049, -2423, -2777, -3192, -3688, -4224, -4771, -5287, -5773, -6279, -6825, -7432, -8090, -8778, -9446, -10094, -10721, -11348, -11966, -12593, -13200, -13797, -14354, -14910, -15518, -16226, -17066, -17987, -18877, -19626, -20193, -20628, -21023, -21468, -21984, -22551, -23107, -23623, -24028, -24291, -24352, -24170, -23674, -22793, -21478, -19707, -17622, -15406, -13231, -11187, -9163, -7088, -4852, -2575, -571, 834, 1401, 1421, 1482, 2150, 3820, 6076, 8363, 10094, 10944, 11156, 11004, 10772, 10569, 10326, 9962, 9426, 8738, 7989, 7270, 6653, 6137, 5671, 5236, 4791, 4366, 3981, 3658, 3395, 3142, 2858, 2514, 2109, 1654, 1178, 683, 187, -328, -844, -1391, -1947, -2514, -3111, -3708, -4305, -4872, -5408, -5904, -6400, -6906, -7452, -8049, -8687, -9395, -10144, -10903, -11632, -12279, -12826, -13312, -13747, -14172, -14607, -15062, -15548, -16094, -16671, -17299, -17936, -18604, -19282, -20001, -20749, -21478, -22065, -22328, -22126, -21488, -20628, -19758, -19059, -18361, -17319, -15558, -12876, -9598, -6218, -3212, -855, 1017, 2615, 4154, 5722, 7260, 8687, 9952, 11035, 11966, 12765, 13453, 14000, 14344, 14465, 14324, 13979, 13494, 12927, 12320, 11672, 11014, 10347, 9689, 9051, 8454, 7918, 7422, 6926, 6410, 5854, 5246, 4568, 3840, 3081, 2342, 1695, 1199, 844, 561, 298, -15, -389, -814, -1269, -1745, -2221, -2676, -3081, -3445, -3830, -4295, -4902, -5651, -6491, -7361, -8211, -9011, -9750, -10397, -10964, -11450, -11895, -12320, -12725, -13140, -13565, -13990, -14445, -14931, -15457, -16044, -16681, -17349, -18007, -18645, -19201, -19626, -19879, -19869, -19545, -18827, -17622, -15963, -13959, -11763, -9486, -7210, -4973, -2818, -774, 1158, 3030, 4852, 6653, 8424, 10134, 11784, 13342, 14759, 16013, 17066, 17896, 18564, 19080, 19484, 19758, 19889, 19839, 19606, 19181, 18604, 17855, 17005, 16115, 15265, 14536, 13939, 13393, 12856, 12259, 11601, 10934, 10286, 9679, 9132, 8626, 8181, 7756, 7331, 6855, 6289, 5631, 4923, 4204, 3516, 2858, 2221, 1593, 946, 298, -349, -976, -1603, -2221, -2848, -3496, -4164, -4821, -5459, -6056, -6633, -7220, -7857, -8555, -9314, -10083, -10832, -11531, -12198, -12826, -13433, -14020, -14587, -15143, -15680, -16206, -16742, -17319, -17906, -18412, -18675, -18553, -17926, -16843, -15346, -13504, -11379, -9072, -6683, -4305, -1988, 247, 2373, 4366, 6258, 8070, 9841, 11591, 13291, 14890, 16378, 17703, 18867, 19869, 20719, 21387, 21873, 22176, 22298, 22217, 21964, 21539, 20972, 20284, 19515, 18725, 17936, 17167, 16438, 15760, 15133, 14526, 13909, 13261, 12603, 11966, 11399, 10913, 10498, 10094, 9658, 9183, 8657, 8110, 7554, 6987, 6400, 5793, 5145, 4457, 3759, 3051, 2352, 1674, 1037, 460, -55, -551, -1057, -1624, -2261, -2970, -3718, -4498, -5277, -6026, -6693, -7260, -7766, -8252, -8768, -9365, -10013, -10681, -11328, -11956, -12583, -13231, -13929, -14647, -15335, -15922, -16358, -16560, -16428, -15872, -14850, -13403, -11612, -9547, -7301, -4953, -2605, -328, 1846, 3941, 6005, 8060, 10073, 12006, 13797, 15406, 16863, 18189, 19424, 20598, 21670, 22662, 23522, 24241, 24747, 24999, 24939, 24595, 24038, 23340, 22581, 21782, 20962, 20152, 19363, 18604, 17896, 17228, 16600, 15983, 15325, 14617, 13868, 13119, 12441, 11854, 11338, 10853, 10326];
		// 43 f 160bpm exercise
		var ppg4 = [-3381, -1155, 972, 2909, 4556, 5799, 6523, 6630, 6127, 5288, 4388, 3648, 2970, 2169, 1079, -301, -1833, -3389, -4830, -6088, -7095, -7781, -8254, -8628, -9024, -9489, -9955, -10382, -10778, -11289, -12097, -13302, -14591, -15491, -15544, -14659, -13073, -11037, -8788, -6515, -4396, -2596, -1315, -751, -1086, -2222, -3740, -5204, -6302, -7110, -7758, -8368, -8986, -9619, -10275, -10953, -11647, -12341, -13035, -13721, -14400, -15056, -15620, -15971, -15994, -15742, -15483, -15491, -15933, -16451, -16581, -15887, -14339, -12151, -9573, -6859, -4373, -2459, -1391, -1056, -1246, -1750, -2459, -3328, -4312, -5372, -6454, -7522, -8529, -9421, -10153, -10694, -11022, -11182, -11182, -11091, -11030, -11144, -11548, -12303, -13455, -15018, -16627, -17557, -17069, -14835, -11464, -7713, -4258, -1422, 629, 1734, 1986, 1696, 1185, 682, 102, -659, -1711, -3008, -4396, -5768, -7057, -8300, -9550, -10809, -12013, -13081, -13920, -14415, -14431, -13851, -12791, -11724, -11136, -11350, -12120, -13096, -13920, -14347, -14187, -13241, -11480, -9116, -6355, -3450, -690, 1628, 3206, 3953, 3915, 3137, 1765, 118, -1475, -2756, -3808, -4823, -5989, -7278, -8529, -9581, -10359, -10969, -11548, -12212, -12928, -13645, -14316, -14957, -15635, -16436, -17389, -18358, -19227, -19829, -19936, -19280, -17595, -14972, -11838, -8643, -5791, -3572, -2260, -2093, -2848, -4136, -5562, -6881, -8010, -8864, -9444, -9932, -10587, -11609, -12967, -14507, -16078, -17527, -18693, -19441, -19707, -19730, -19822, -20256, -21050, -22071, -23169, -24168, -24855, -25000, -24435, -23253, -21614, -19662, -17572, -15506, -13630, -12082, -10931, -10244, -10061, -10305, -10885, -11701, -12623, -13538, -14309, -14888, -15384, -15895, -16520, -17252, -18037, -18823, -19479, -19784, -19540, -18777, -18022, -17885, -18831, -20554, -22483, -24054, -24923, -24893, -23818, -21698, -18899, -15872, -13005, -10458, -8254, -6439, -4983, -3770, -2687, -1719, -1063, -972, -1628, -2924, -4571, -6294, -7888, -9230, -10214, -10755, -10923, -10793, -10458, -10084, -9878, -10046, -10656, -11632, -12867, -14232, -15384, -15979, -15674, -14522, -12784, -10732, -8551, -6325, -4129, -2024, -49, 1780, 3435, 4815, 5799, 6256, 6142, 5555, 4594, 3359, 1948, 430, -1109, -2550, -3755, -4563, -4945, -5036, -5028, -5059, -5128, -5196, -5219, -5189, -5173, -5227, -5349, -5471, -5501, -5333, -4922, -4197, -3114, -1666, 57, 2009, 4060, 6012, 7636, 8742, 9390, 9779, 10061, 10267, 10229, 9764, 8780, 7408, 5822, 4174, 2642, 1361, 476, -3, -270, -522, -926, -1498, -2222, -3099, -4045, -4960, -5730, -6302, -6668, -6820, -6744, -6310, -5379, -3816, -1864, 49, 1475, 2276, 2779, 3336, 4182, 4975, 5219, 4441, 2710, 461, -1856, -3915, -5570, -6737, -7347, -7644, -7941, -8544, -9466, -10488, -11388, -12021, -12425, -12669, -12814, -12989, -13310, -13912, -14682, -15277, -15376, -14774, -13599, -12044, -10275, -8407, -6531, -4731, -3099, -1719, -674, -41, 110, -270, -1239, -2741, -4662, -6897, -9261, -11449, -13165, -14225, -14842, -15292, -15826, -16482, -17191, -17870, -18503, -19151, -19890, -20760, -21675, -22544, -23261, -23665, -23589, -22849, -21393, -19364, -16886, -14171, -11579, -9543, -8429, -8124, -8140, -7995, -7530, -7133, -7240, -8178, -9672, -11304, -12662, -13714, -14675, -15788, -17161, -18602, -19898, -20867, -21477, -21728, -21660, -21377, -21088, -20996, -21194, -21477, -21644, -21461, -20790, -19509, -17504, -14881, -11983, -9154, -6653, -4472, -2596, -995, 278, 1170, 1612, 1635, 1422, 1132, 903, 735, 606, 476, 202, -407, -1559, -3206, -5013, -6630, -7758, -8300, -8185, -7377, -6172, -5059, -4518, -4685, -5242, -5829, -6127, -5951, -5181, -3694, -1612, 789, 3252, 5585, 7751, 9741, 11487, 12761, 13294, 12860, 11632, 10130, 8864, 8063, 7491, 6851, 5905, 4769, 3625, 2687, 2032, 1650, 1528, 1574, 1567, 1254, 453, -690, -1902, -2939, -3557, -3595, -2863, -1307, 842, 3320, 5867, 8330, 10580, 12486, 13958, 14911, 15269, 15010, 14278, 13256, 12113, 10877, 9558, 8140, 6599, 4899, 3000, 949, -964, -2382, -3023, -3053, -2931, -3092, -3778, -4914, -6454, -8239, -9947, -11159, -11541, -11075, -9977, -8475, -6721, -4792, -2756, -690, 1269, 2985, 4312, 5227, 5814, 6134, 6218, 6035, 5539, 4723, 3641, 2367, 995, -453, -2001, -3656, -5356, -6881, -7987, -8475, -8429, -8018, -7408, -6744, -6157, -5776, -5692, -5951, -6576, -7537, -8422, -8666, -7728, -5578, -2710, 377, 3282, 5921, 8224, 10122, 11502, 12189, 12036, 11098, 9695, 8147, 6744, 5669, 5082, 5120, 5478, 5677, 5227, 4052, 2588, 1277, 461, 34, -209, -438, -621, -606, -232, 468, 1216, 1719, 1811, 1811, 2184, 3343, 5265, 7667, 10252, 12784, 15109, 17115, 18632, 19494, 19494, 18465, 16589, 14301, 12059, 10191, 8811, 8018, 7835, 7949, 7949, 7430, 6371, 5044, 3747, 2665, 1780, 1056, 461, -49, -507, -941, -1284, -1353, -949, -19, 1201, 2405, 3381, 4266, 5356, 6935, 9009, 11236, 13287, 14842, 15666, 15521, 14240, 12090, 9550, 7095, 4945, 3008, 1170, -590, -2131, -3236, -3740, -3755, -3572, -3458, -3618, -4113, -4990, -6256, -7728, -9169, -10359, -11136, -11358, -10885, -9741, -8132, -6294, -4441, -2710, -1201, -34, 781, 1246, 1406, 1239, 674, -369, -1910, -3725, -5532, -7049, -8315, -9604, -11182, -13104, -14942, -16215, -16551, -16131, -15330, -14522, -13965, -13813, -14225, -15239, -16657, -18243, -19761, -20920, -21431, -21027, -19753, -18022, -16230, -14644, -13165, -11602, -9833, -8002, -6371, -5181, -4617, -4716, -5532, -7003, -8727, -10252, -11190, -11640, -11952, -12471, -13272, -14026, -14431, -14255, -13706, -13073, -12616, -12509, -12845, -13721, -14980, -16055, -16398, -15590, -13874, -11670, -9360, -7171, -5234, -3671, -2459, -1338, -19, 1650, 3282, 4304, 4220, 3084, 1361, -453, -2047, -3442, -4662, -5776, -6828, -7896, -9039, -10145, -10969, -11266, -10938, -10244, -9489, -8925, -8681, -8795, -9322, -10069, -10641, -10648, -9833, -8368, -6447, -4266, -1841, 888, 3961, 7072, 9550, 10694, 10130, 8315, 5844, 3298, 979, -926, -2245, -3038, -3641, -4418, -5585, -6965, -8269, -9268, -9947, -10435, -10847, -11297, -11891, -12723, -13813, -14926, -15773, -16085, -15872, -15285, -14492, -13561, -12410, -10953, -9131, -7072, -4937, -2893, -1048, 537, 1788, 2672, 3183, 3313, 3076, 2421, 1292, -346, -2428, -4784, -7263, -9619, -11457, -12372, -12090, -11060, -9993, -9566, -9955, -10892, -12090, -13317, -14438, -15346, -15925, -16085, -15727, -14751, -13134, -10892, -8056, -4792, -1612, 880, 2215, 2543, 2329, 2032, 1872, 1826, 1864, 1902, 1727, 1094, -171, -1833, -3450, -4571, -5051, -5150, -5128, -5211, -5478, -5959, -6660, -7446, -8094, -8384, -8414, -8757, -10016, -12357, -14278, -13843, -9352, -1734, 6363, 12296, 14850, 15193, 14698, 14507, 14644, 14797, 14705, 14217, 13310, 11960, 10252, 8513, 7087, 6203, 5593, 4815, 3458, 1582, -362, -1894, -2779, -3221, -3496, -3839, -4190, -4396, -4296, -3786, -2771, -1193, 956, 3488, 6195, 8872, 11380, 13599, 15430, 16947, 18411, 20104, 22102, 23924, 25000, 24839, 23627, 21858, 20028, 18327, 16634, 14766, 12684, 10740, 9352, 8887, 9093, 9398, 9238, 8315, 6721, 4556, 2001, -461, -2321, -3084, -2733, -1513, 301, 2512, 5006, 7667, 10351, 12822, 14812, 16055, 16535, 16398, 15796, 14865, 13775, 12662, 11640, 10641, 9527, 8170, 6569, 4807, 2992, 1246, -224, -1201, -1551, -1536, -1567, -2016, -2893, -3862, -4556, -4807, -4838, -4914, -5242, -5562, -5440, -4441, -2535, -80, 2558, 5067, 7247, 8948, 10031, 10565, 10732, 10687, 10481, 10046, 9291, 8163, 6668, 4853, 2764, 568, -1452, -3061, -4144, -4792, -5097, -5196, -5364, -5883, -7003, -8605, -10321, -11792, -12768, -13172, -12921, -11975, -10404, -8315, -5814, -3114, -507, 1727, 3450, 4762, 5783, 6622, 7308, 7827, 8170, 8231, 7804, 6706, 4937, 2863, 895, -621, -1605, -2077, -2055, -1673, -1170, -773, -667, -888, -1483, -2489, -3900, -5730, -7972, -10321, -12212, -13073, -12540, -10793, -8094, -4693, -987, 2604, 5684, 8025, 9665, 10633, 10992, 10938, 10671, 10382, 9977, 9245, 7980, 6195, 4167, 2207, 514, -1010, -2535, -4182, -5822, -7148, -7888, -7995, -7804, -7659, -7812, -8254, -8895, -9627, -10244, -10481, -10061, -8879, -7103, -4914, -2474, 102, 2741, 5341, 7720, 9634, 10839, 11197, 10755, 9588, 7812, 5745, 3778, 2260, 1162, 87, -1338, -3267, -5394, -7354, -8841, -9878, -10587, -11098, -11472, -11701, -11777, -11754, -11785, -12044, -12662, -13409, -13950, -13920, -13249, -12120, -10709, -9154, -7461, -5600];
		// 54 m noisy
		var ppg5 = [5947, 6715, 7321, 7599, 7426, 6888, 6235, 5697, 5351, 5034, 4554, 3814, 2920, 2065, 1431, 1056, 931, 1028, 1287, 1556, 1710, 1662, 1575, 1642, 2046, 2651, 3237, 3554, 3478, 2997, 2123, 922, -393, -1585, -2421, -2824, -2815, -2373, -1652, -931, -509, -557, -980, -1633, -2373, -3064, -3622, -3920, -4083, -4381, -5121, -6418, -7936, -9319, -10213, -10367, -9550, -7590, -4727, -1614, 1095, 3026, 4313, 5159, 5745, 6206, 6658, 7215, 7945, 8868, 10011, 11318, 12634, 13787, 14594, 14959, 14767, 13941, 12653, 11212, 9973, 9089, 8483, 8070, 7763, 7475, 7138, 6687, 6216, 5870, 5803, 6033, 6360, 6571, 6523, 6360, 6274, 6437, 6783, 7138, 7330, 7282, 7071, 6773, 6456, 6187, 6014, 5985, 5976, 5774, 5169, 4208, 3161, 2325, 1883, 1652, 1441, 1047, 509, -57, -538, -903, -1229, -1575, -1969, -2353, -2661, -2805, -2594, -1806, -240, 2008, 4506, 6850, 8752, 10184, 11174, 11750, 12086, 12394, 12865, 13508, 14210, 14834, 15324, 15747, 16179, 16660, 16986, 16890, 16141, 14844, 13335, 11990, 11049, 10578, 10626, 11174, 11952, 12576, 12720, 12442, 12038, 11808, 11865, 12134, 12471, 12749, 12788, 12384, 11404, 10040, 8704, 7820, 7494, 7436, 7359, 7023, 6514, 5956, 5486, 5149, 4967, 4957, 5044, 5044, 4784, 4189, 3458, 2853, 2594, 2594, 2632, 2488, 2132, 1729, 1450, 1421, 1642, 2075, 2709, 3516, 4458, 5524, 6658, 7792, 8868, 9857, 10818, 11817, 12932, 14085, 15199, 16179, 16890, 17169, 16852, 15930, 14767, 13729, 13114, 12711, 12182, 11183, 9713, 8061, 6495, 5294, 4688, 4928, 6139, 7840, 9406, 10242, 10232, 9598, 8570, 7369, 6225, 5351, 4890, 4611, 4198, 3372, 2219, 1076, 259, -115, -220, -259, -393, -624, -941, -1306, -1758, -2286, -2949, -3689, -4448, -5121, -5649, -5995, -6168, -6168, -6101, -6139, -6437, -6936, -7359, -7378, -6821, -5860, -4727, -3622, -2584, -1585, -595, 393, 1345, 2229, 3007, 3641, 4112, 4400, 4525, 4563, 4573, 4515, 4275, 3727, 2853, 1806, 778, -57, -787, -1546, -2459, -3497, -4486, -5274, -5774, -6110, -6437, -6869, -7388, -7945, -8464, -8887, -9108, -9050, -8724, -8378, -8243, -8522, -9060, -9656, -10107, -10415, -10722, -11174, -11769, -12336, -12701, -12740, -12634, -12624, -12961, -13576, -14267, -14844, -15238, -15555, -15939, -16448, -16996, -17419, -17592, -17524, -17313, -17025, -16708, -16323, -15824, -15199, -14411, -13470, -12355, -11202, -10165, -9406, -8954, -8695, -8503, -8272, -7993, -7609, -7138, -6648, -6264, -6120, -6264, -6725, -7484, -8512, -9636, -10664, -11452, -12009, -12423, -12778, -13114, -13431, -13720, -13998, -14277, -14584, -14940, -15334, -15728, -16093, -16420, -16669, -16833, -16900, -16958, -17063, -17275, -17582, -17928, -18255, -18572, -18860, -19139, -19398, -19648, -19888, -20128, -20359, -20551, -20705, -20849, -21070, -21454, -21983, -22559, -23049, -23357, -23433, -23232, -22713, -21915, -20887, -19686, -18351, -16881, -15286, -13585, -11885, -10280, -8897, -7753, -6821, -6101, -5505, -4900, -4141, -3199, -2382, -2027, -2421, -3353, -4333, -4928, -5005, -4832, -4659, -4669, -4813, -5005, -5178, -5284, -5322, -5274, -5159, -5063, -5044, -5121, -5130, -4919, -4362, -3574, -2767, -2152, -1863, -1960, -2517, -3487, -4573, -5476, -5937, -5966, -5649, -5092, -4419, -3804, -3420, -3333, -3420, -3535, -3564, -3535, -3526, -3602, -3737, -3852, -3862, -3737, -3535, -3324, -3132, -2872, -2421, -1681, -643, 643, 2142, 3766, 5466, 7148, 8762, 10290, 11702, 12990, 14152, 15161, 16026, 16756, 17390, 17976, 18533, 19023, 19369, 19523, 19523, 19436, 19312, 19129, 18735, 17966, 16765, 15372, 14056, 13076, 12538, 12490, 12970, 13864, 14873, 15718, 16170, 16199, 15785, 14959, 13921, 12961, 12355, 12106, 12000, 11798, 11375, 10818, 10261, 9828, 9607, 9665, 10059, 10722, 11423, 11942, 12115, 11913, 11289, 10270, 9079, 7984, 7254, 6917, 6802, 6725, 6571, 6302, 5889, 5351, 5073, 5514, 7071, 9531, 12279, 14700, 16477, 17774, 18783, 19696, 20637, 21714, 23011, 24260, 25000, 24769, 23587, 22136, 21147, 21089, 21569, 22011, 21925, 21300, 20416, 19552, 18860, 18370, 18101, 18034, 18043, 18024, 17842, 17457, 16890, 16151, 15286, 14431, 13691, 13162, 12855, 12788, 12932, 13182, 13374, 13345, 13076, 12692, 12298, 11971, 11644, 11241, 10732, 10251, 10059, 10357, 11058, 11817, 12288, 12250, 11856, 11260, 10607, 9944, 9262, 8560, 7907, 7465, 7359, 7599, 7984, 8262, 8214, 7744, 6792, 5313, 3583, 2084, 1335, 1566, 2661, 4458, 6735, 9185, 11433, 13162, 14306, 15007, 15401, 15593, 15661, 15670, 15689, 15785, 16035, 16487, 17054, 17601, 17957, 17986, 17553, 16554, 14969, 13134, 11423, 10213, 9492, 9069, 8762, 8464, 8147, 7792, 7388, 7013, 6725, 6600, 6543, 6446, 6177, 5755, 5361, 5149, 5226, 5447, 5620, 5582, 5236, 4486, 3266, 1700, 86, -1239, -2065, -2411, -2325, -1863, -1268, -855, -903, -1460, -2344, -3372, -4419, -5428, -6322, -7081, -7696, -8205, -8627, -9002, -9377, -9800, -10270, -10693, -10953, -10972, -10732, -10242, -9511, -8531, -7254, -5659, -3823, -1998, -490, 499, 951, 893, 393, -355, -1076, -1489, -1546, -1518, -1700, -2296, -3161, -4073, -4861, -5476, -6024, -6552, -7109, -7715, -8349, -8993, -9502, -9723, -9521, -9050, -8589, -8416, -8618, -9031, -9492, -9896, -10232, -10530, -10799, -11097, -11500, -12077, -12817, -13624, -14392, -15036, -15526, -15795, -15853, -15814, -15872, -16208, -16775, -17332, -17659, -17630, -17467, -17409, -17649, -18197, -18966, -19898, -20878, -21800, -22540, -23068, -23453, -23818, -24231, -24625, -24913, -25000, -24807, -24279, -23357, -22079, -20609, -19119, -17784, -16602, -15584, -14709, -13960, -13268, -12615, -11971, -11385, -10885, -10520, -10242, -10011, -9790, -9569, -9358, -9156, -9002, -8935, -9012, -9252, -9607, -10001, -10376, -10693, -10924, -11058, -11078, -10953, -10693, -10290, -9838, -9435, -9166, -9031, -9012, -9069, -9185, -9310, -9425, -9502, -9502, -9406, -9204, -8935, -8685, -8522, -8445, -8387, -8272, -8080, -7840, -7638, -7513, -7475, -7513, -7609, -7734, -7840, -7859, -7820, -7840, -8089, -8656, -9444, -10280, -11001, -11462, -11529, -11106, -10165, -8877, -7436, -6004, -4583, -3132, -1604, -19, 1585, 3141, 4621, 5976, 7138, 8118, 8983, 9828, 10760, 11673, 12375, 12653, 12471, 12029, 11558, 11231, 11126, 11289, 11740, 12365, 12961, 13335, 13383, 13143, 12653, 11981, 11289, 10722, 10453, 10453, 10645, 10933, 11279, 11635, 11981, 12269, 12365, 12115, 11414, 10415, 9387, 8589, 8186, 8205, 8666, 9531, 10463, 11145, 11279, 10981, 10539, 10213, 10088, 10088, 10136, 10146, 10001, 9569, 8791, 7801, 6831, 6110, 5726, 5668, 5928, 6427, 6975, 7388, 7503, 7465, 7503, 7811, 8483, 9483, 10770, 12269, 13816, 15228, 16381, 17361, 18303, 19321, 20320, 21060, 21300, 21012, 20522, 20167, 20234, 20657, 21348, 22184, 22982, 23539, 23654, 23289, 22674, 22059, 21608, 21243, 20820, 20244, 19619, 19206, 19235, 19734, 20416, 21012, 21310, 21329, 21147, 20839, 20513, 20292, 20292, 20436, 20407, 19907, 18774, 17352, 16006, 15094, 14681, 14681, 15026, 15584, 16093, 16352, 16199, 15757, 15142, 14479, 13835, 13210, 12663, 12182, 11769, 11433, 11154, 10885, 10588, 10232, 9809, 9319, 8781, 8310, 8099, 8358, 9127, 10088, 10943, 11414, 11673, 11961, 12528, 13470, 14757, 16372, 18187, 19917, 21252, 21992, 22242, 22232, 22165, 22127, 22107, 22117, 22098, 21906, 21377, 20455, 19340, 18332, 17669, 17255, 16775, 15930, 14642, 13172, 11760, 10645, 10001, 9944, 10578, 11606, 12557, 12932, 12672, 12163, 11798, 11856, 12163, 12480, 12596, 12432, 12038, 11404, 10636, 9886, 9300, 8954, 8695, 8339, 7724, 6898, 6014, 5188, 4515, 4064, 3872, 3920, 4064, 4112, 3929, 3449, 2680, 1594, 317, -989, -2123, -2940, -3343, -3266, -2651, -1671, -509, 605, 1623, 2594, 3554, 4525, 5457, 6274, 6927, 7465, 7916, 8320, 8704, 9050, 9329, 9531, 9617, 9569, 9367, 9041, 8627, 8166, 7647, 7033, 6302, 5476, 4650, 3920, 3324, 2699, 1835, 547, -980, -2382, -3285, -3593, -3554, -3449, -3478, -3699, -4112, -4717, -5332, -5745, -5707, -5255, -4717, -4438, -4640, -5188, -5918, -6648, -7350, -8013, -8656, -9242, -9723, -10030, -10174, -10270, -10472, -10905, -11491, -12106, -12615, -12999, -13335, -13720, -14191, -14671, -15084, -15363, -15536, -15651, -15766, -15805, -15622, -15046, -14027, -12701, -11250, -9819, -8531, -7484, -6773, -6322, -5966, -5514, -4871, -4083, -3237, -2373, -1556, -845, -297, 28, 19];
		// 60 m noisy
		var ppg6 = [138, 946, 1347, 952, -584, -2901, -5201, -6681, -7026, -6585, -5743, -4901, -4398, -4568, -5687, -7466, -9303, -10597, -11122, -11088, -10744, -10320, -10003, -9958, -10331, -11021, -11806, -12484, -12879, -12863, -12309, -11230, -9964, -8913, -8404, -8252, -8060, -7455, -6399, -5206, -4189, -3534, -3076, -2624, -1991, -1178, -240, 765, 1754, 2590, 3150, 3387, 3404, 3325, 3263, 3223, 3172, 3093, 2974, 2822, 2641, 2443, 2240, 2065, 1923, 1822, 1748, 1697, 1680, 1726, 1850, 2048, 2257, 2409, 2460, 2449, 2421, 2432, 2494, 2618, 2788, 2997, 3200, 3364, 3477, 3652, 4020, 4664, 5314, 5523, 4833, 3308, 1618, 483, 290, 545, 550, -257, -1562, -2630, -2748, -1861, -652, 189, 228, -251, -856, -1285, -1923, -3426, -6410, -10670, -15219, -19038, -21508, -22931, -23728, -24282, -24689, -24932, -25000, -24734, -23841, -22033, -19242, -15874, -12377, -9122, -6105, -3189, -257, 2573, 5009, 6755, 7709, 8116, 8263, 8382, 8540, 8749, 9003, 9224, 9252, 8941, 8286, 7495, 6800, 6376, 6173, 6071, 5986, 5884, 5805, 5760, 5766, 5800, 5833, 5850, 5867, 5907, 5986, 6110, 6280, 6489, 6732, 6997, 7274, 7540, 7789, 7992, 8139, 8297, 8563, 9020, 9529, 9710, 9179, 7794, 6065, 4607, 3935, 4048, 4743, 5783, 6766, 7094, 6167, 3873, 1110, -1053, -1793, -1454, -816, -618, -1104, -2070, -3308, -4613, -5783, -6619, -6981, -7105, -7331, -7964, -8947, -9953, -10659, -10891, -10783, -10484, -10128, -9721, -9246, -8687, -7902, -6687, -4856, -2500, -177, 1534, 2234, 2223, 1969, 1906, 2149, 2630, 3280, 4042, 4879, 5760, 6641, 7421, 8020, 8342, 8438, 8416, 8382, 8382, 8393, 8387, 8342, 8269, 8190, 8116, 8043, 7958, 7845, 7709, 7585, 7506, 7483, 7506, 7551, 7596, 7647, 7715, 7817, 7941, 8071, 8195, 8303, 8421, 8585, 8817, 9082, 9342, 9557, 9738, 9953, 10269, 10665, 10947, 10891, 10371, 9642, 9082, 9037, 9376, 9653, 9393, 8371, 6732, 4664, 2342, -115, -2613, -5042, -7359, -9529, -11535, -13337, -14919, -16236, -17253, -17891, -18067, -17694, -16671, -14919, -12337, -9026, -5291, -1483, 2127, 5466, 8484, 11134, 13292, 14801, 15513, 15524, 15236, 15061, 15168, 15111, 14332, 12388, 9732, 7201, 5602, 5093, 5167, 5291, 5110, 4737, 4319, 3997, 3782, 3619, 3460, 3291, 3133, 3008, 2929, 2873, 2805, 2709, 2601, 2500, 2421, 2375, 2336, 2285, 2217, 2144, 2087, 2059, 2048, 2031, 1991, 1929, 1839, 1726, 1601, 1471, 1341, 1217, 1104, 997, 895, 799, 709, 618, 533, 449, 358, 262, 172, 127, 132, 183, 262, 330, 381, 392, 347, 257, 161, 115, 166, 347, 675, 1155, 1793, 2568, 3460, 4449, 5489, 6528, 7534, 8450, 9218, 9794, 10179, 10427, 10597, 10715, 10766, 10721, 10557, 10280, 9919, 9501, 9037, 8557, 8071, 7608, 7150, 6704, 6263, 5856, 5511, 5252, 5082, 4963, 4856, 4743, 4630, 4523, 4432, 4353, 4274, 4189, 4099, 3997, 3895, 3799, 3715, 3652, 3613, 3590, 3568, 3517, 3449, 3370, 3280, 3189, 3093, 2991, 2878, 2760, 2641, 2528, 2432, 2336, 2257, 2189, 2133, 2087, 2048, 2025, 2020, 2025, 2036, 2031, 1997, 1940, 1873, 1816, 1788, 1788, 1805, 1827, 1861, 1895, 1935, 1969, 2003, 2036, 2076, 2178, 2392, 2771, 3364, 4217, 5370, 6743, 8161, 9450, 10501, 11376, 12151, 12879, 13546, 14106, 14507, 14761, 14908, 14981, 14998, 14948, 14818, 14597, 14275, 13857, 13343, 12766, 12173, 11625, 11134, 10687, 10258, 9840, 9444, 9105, 8828, 8625, 8455, 8297, 8144, 7986, 7839, 7698, 7579, 7495, 7455, 7444, 7438, 7416, 7365, 7297, 7218, 7139, 7048, 6958, 6856, 6755, 6664, 6596, 6545, 6500, 6444, 6370, 6286, 6195, 6110, 6037, 5969, 5918, 5873, 5828, 5771, 5698, 5630, 5579, 5562, 5562, 5568, 5568, 5551, 5523, 5489, 5455, 5415, 5365, 5314, 5257, 5206, 5161, 5133, 5105, 5071, 5031, 5003, 5003, 5031, 5076, 5133, 5178, 5206, 5229, 5240, 5246, 5263, 5308, 5393, 5557, 5828, 6252, 6868, 7721, 8856, 10229, 11676, 13021, 14128, 15021, 15727, 16292, 16739, 17083, 17349, 17547, 17677, 17727, 17699, 17586, 17377, 17066, 16654, 16140, 15530, 14851, 14151, 13478, 12874, 12343, 11896, 11535, 11241, 10998, 10778, 10574, 10388, 10224, 10088, 9958, 9828, 9687, 9546, 9410, 9292, 9195, 9105, 9026, 8941, 8851, 8738, 8613, 8472, 8348, 8241, 8156, 8077, 7975, 7856, 7738, 7647, 7596, 7568, 7534, 7461, 7365, 7257, 7178, 7122, 7088, 7054, 7014, 6964, 6913, 6862, 6811, 6738, 6636, 6500, 6365, 6263, 6206, 6184, 6189, 6206, 6218, 6240, 6257, 6269, 6286, 6297, 6302, 6302, 6280, 6240, 6173, 6093, 6009, 5930, 5907, 5969, 6167, 6545, 7167, 8065, 9184, 10422, 11687, 12908, 14043, 15044, 15885, 16569, 17089, 17468, 17722, 17880, 17982, 18027, 17999, 17880, 17671, 17383, 17016, 16592, 16117, 15609, 15089, 14569, 14072, 13614, 13219, 12879, 12614, 12422, 12281, 12173, 12071, 11975, 11891, 11812, 11744, 11665, 11552, 11399, 11224, 11054, 10924, 10828, 10749, 10665, 10563, 10455, 10348, 10241, 10145, 10071, 10015, 9975, 9941, 9907, 9868, 9800, 9710, 9597, 9472, 9371, 9314, 9303, 9325, 9365, 9421, 9472, 9506, 9512, 9506, 9489, 9478, 9478, 9478, 9478, 9484, 9472, 9438, 9382, 9314, 9252, 9218, 9207, 9201, 9190, 9179, 9167, 9167, 9184, 9224, 9286, 9388, 9625, 10122, 10975, 12184, 13659, 15303, 17004, 18637, 20067, 21186, 22056, 22751, 23350, 23875, 24305, 24610, 24802, 24909, 24971, 25000, 24977, 24870];

		let ppg;
		let wavelet;
		let maxScale = 0;
		let coeffsInv;
		let reconstructIndexes = [];
		let ppgChart;
		let waveletChart;
		let scaleChart;
		let reconstructChart;
		const fs = 100;
		const ppgCanvas = document.getElementById('ppgCanvas');
		const waveletCanvas = document.getElementById('waveletCanvas');
		const scalesWrapper = document.getElementById('scalesWrapper');
		const reconstructsCBs = document.getElementById('reconstructsCBs');
		const reconstructCanvas = document.getElementById('reconstructCanvas');

		const signalSelect = document.getElementById('signals');
		signalSelect.addEventListener('change', () => {
			ppg = window[signalSelect.value];
			scalesWrapper.replaceChildren();

			if (ppgChart) {
				ppgChart.destroy();
			}
			ppgChart = addLine(ppg, fs, "ppg", ppgCanvas);

			if (wavelet) {
				waveletSelect.dispatchEvent(new Event('change'));
			}
		});

		const waveletSelect = document.getElementById('wavelets');
		waveletSelect.addEventListener('change', () => {
			wavelet = waveletSelect.value;

			if (!ppg) {
				return;
			}
			
			maxScale = wt.maxLevel(ppg.length, wavelet);
			const coeffs = wt.wavedec(ppg, wavelet, 'symmetric', maxScale);

			if (waveletChart) {
				waveletChart.destroy();
			}
			waveletChart = addLine(
				coeffs[0], 
				coeffs[0].length * fs / ppg.length, 
				"Aprox " + maxScale + "; ind:" + 0 + " len:" + coeffs[0].length, 
				waveletCanvas
			);

			scalesWrapper.replaceChildren();
			for (let i = 1; i < coeffs.length; i++) {
				let scaleCanvas = document.createElement('canvas');
				scaleCanvas.setAttribute('id', 'sc' + i);
				scaleCanvas.setAttribute('height', 50);
				scalesWrapper.appendChild(scaleCanvas);
				addLine(
					coeffs[i], 
					coeffs[i].length * fs / ppg.length, 
					"Details scale:" + (maxScale - i + 1) + "; ind:" + i + " len:" + coeffs[i].length,
					scaleCanvas
				);
			}

			// Reconstruct
			coeffsInv = wt.wavedec(ppg, wavelet, 'symmetric', maxScale);
			addCoeffCBs(coeffsInv.length);
		});

		function addCoeffCBs(length) {
			reconstructIndexes = [];
			reconstructsCBs.replaceChildren();
			if (reconstructChart) {
				reconstructChart.destroy();
			}

			if (!length) {
				return;
			}

			for (let i = 0; i < length; i++) {
				const cbElement = document.createElement('input');
				cbElement.setAttribute('type', 'checkbox');
				cbElement.setAttribute('id', 'reconCB' + i);
				cbElement.setAttribute('value', i);
				cbElement.setAttribute('name', 'index ' + i);
				cbElement.addEventListener('change', updateReconstructChart);

				const cbLabel = document.createElement('label');
				cbLabel.setAttribute('for', 'reconCB' + i);
				cbLabel.textContent = 'index ' + i;

				reconstructsCBs.appendChild(cbElement);
				reconstructsCBs.appendChild(cbLabel);
			};
		}

		function updateReconstructChart(event) {
			if (event.target.checked) {
				reconstructIndexes.push(+event.target.defaultValue);
			} else {
				const index = reconstructIndexes.indexOf(+event.target.defaultValue);
				index > -1 && reconstructIndexes.splice(index, 1);
			}

			const coeffs = JSON.parse(JSON.stringify(coeffsInv));

			for (let i = 0; i < coeffs.length; i++) {
				if (!reconstructIndexes.includes(i)) {
					for (let j = 0; j < coeffs[i].length; j++) {
						coeffs[i][j] = 0;
					}
				}
			}

			const reconstruct = wt.waverec(coeffs, wavelet);

			if (reconstructChart) {
				reconstructChart.destroy();
			}

			reconstructChart = addLine(
				reconstruct, 
				fs, 
				"ppg reconstruct kept indexes:" + reconstructIndexes, 
				reconstructCanvas
			);
		}

		function addLine(data, fs, name, ctx) {
			let labs = [];
			for (let i = 0; i < data.length; i++) { labs[i] = i / (1.0 * fs); }

			return new Chart(ctx, {
				type: 'line',
				data: {
					labels: labs,
					datasets: [{
						label: name,
						data: data,
						borderWidth: 1,
						cubicInterpolationMode: 'monotone'
					}]
				},
				options: {
					elements: {
						point: {
							radius: 0
						}
					},
					scales: {
						y: {
							beginAtZero: true
						},
						x: {
							ticks: {
								precision: 0
							}
						}
					}
				}
			});
		}

	</script>

</body>

</html>